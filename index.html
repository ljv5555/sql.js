<!doctype html>
<html>
<head><title>In-Browser Client-Side JavaScript SQLITE sample</title>
<style>
table{
width:calc(100% - 20px);
margin: 10px 10px 10px 10px;
padding: 10px 10px 10px 10px;
}
td{width:calc(50% - 10px);}
body{font-family:arial;}
.indiv,.outdiv,h4,td,th
{
margin: 10px 10px 10px 10px;
padding: 10px 10px 10px 10px;
background:black;
color:white;
}
.outdiv, .indiv, .td, .th
{
border:1px solid white;
}
.indiv,.outdiv
{
min-height:100px;
}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min.js"></script>
<script src="js/sqlite.js"></script>
<script>
var db = false;
var dbr = false;

function sqlTableToHtmlTable(st)
{
	var rtn = '<table>';
	var first=true;
	_.each(st,function(row)
	{
		try{console.log(JSON.stringify(row));}catch(ee){}
		if(first)
		{
			first=false;
			rtn+='<tr>';
			_.each(row,function(cell){
				rtn+='<th>'
				+_.escape(cell['column'])
				+'</th>';
			});
			rtn+='</tr>';
		}
		rtn+='<tr>';
		_.each(row,function(cell){
			rtn+='<td title="'
			+_.escape(cell['column'])+'">'
			+_.escape(cell['value'])
			+'</td>';
		});
		rtn+='</tr>';
	});
	rtn+='</table>';
	return rtn;
}

function init()
{
	db = SQL.open();
}
function go()
{
	if(!db){init();}
	dbr=db.exec(jQuery('.indiv').text());
	jQuery('.outdiv').html(sqlTableToHtmlTable(dbr));
}

</script>




</head>
<body>
<h4>In-Browser Client-Side JavaScript SQLITE sample</h4>
<table>
<tr>
<td><h5>Input SQL</h5></td><td><h5>Result</h5></td>
</tr>
<tr>
<td>
<pre id="indiv" class="indiv" contenteditable="true">
CREATE TABLE table1(row_id integer, text1 text, text2 text);
INSERT INTO table1 VALUES(1,'n1','v1');
INSERT INTO table1 VALUES(2,'n2','v2');

select * from table1

</pre>
</td>
<td>
<pre class="outdiv" id="outdiv"></pre>

</td>
</tr>
<tr>
<td>
<button type="button" onclick="go();">Execute</button>
</td>
<td>
</td>
</tr>
</table>
<p/>

</body>
</html>
